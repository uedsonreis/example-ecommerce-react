{"ast":null,"code":"import _defineProperty from \"@babel/runtime/helpers/defineProperty\";\nimport _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport _inherits from \"@babel/runtime/helpers/inherits\";\nimport _possibleConstructorReturn from \"@babel/runtime/helpers/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime/helpers/getPrototypeOf\";\nvar _jsxFileName = \"/Users/uedsonreis/Documents/Projetos/faculdades/aulas/example-ecommerce-react/src/screens/login/index.tsx\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Date.prototype.toString.call(Reflect.construct(Date, [], function () {})); return true; } catch (e) { return false; } }\n\nimport React, { Component } from \"react\";\nimport { Text } from \"native-base\";\nimport api from \"../../utils/connection.api\";\nimport { MenuIcon } from \"../../components/SideMenu/menu.icon\";\nimport { User } from \"../../model/user\";\nimport session from \"../../storage/user.session\";\nimport { Customer } from \"../../model/customer\";\nimport { AuthScreenView } from \"./view\";\nexport var LoginScreen = function (_Component) {\n  _inherits(LoginScreen, _Component);\n\n  var _super = _createSuper(LoginScreen);\n\n  function LoginScreen(props) {\n    var _this;\n\n    _classCallCheck(this, LoginScreen);\n\n    _this = _super.call(this, props);\n    _this.state = {\n      user: new User(),\n      customer: new Customer(),\n      confirmPass: \"\"\n    };\n    return _this;\n  }\n\n  _createClass(LoginScreen, [{\n    key: \"validateForm\",\n    value: function validateForm() {\n      if (this.state.user.login === undefined || this.state.user.login.trim() === '') {\n        alert(\"Este email é inválido!\");\n        return false;\n      }\n\n      if (!this.state.user.login.includes(\"@\") || !this.state.user.login.includes(\".\")) {\n        alert(\"Este email é inválido!\");\n        return false;\n      }\n\n      if (this.state.customer.age === undefined || this.state.customer.age <= 0) {\n        alert(\"Esta idade não é permitida!\");\n        return false;\n      }\n\n      if (this.state.user.password !== this.state.confirmPass) {\n        alert(\"As senhas não conferem!\");\n        return false;\n      }\n\n      this.state.customer.email = this.state.user.login;\n      this.state.customer.user = this.state.user;\n      return true;\n    }\n  }, {\n    key: \"signup\",\n    value: function signup() {\n      var _this2 = this;\n\n      if (!this.validateForm()) return;\n\n      var body = _objectSpread({}, this.state.customer, {\n        userPassword: this.state.customer.user.password\n      });\n\n      api.addCustomer(body).then(function (result) {\n        if (result.ok) {\n          session.login(_this2.state.customer.email, result.data);\n\n          _this2.props.navigation.navigate('salesOrder');\n        } else {\n          alert(\"Ocorreu um erro ao salvar o usuário: \" + JSON.stringify(result.data));\n        }\n      });\n    }\n  }, {\n    key: \"login\",\n    value: function login() {\n      var _this3 = this;\n\n      api.login(this.state.user).then(function (result) {\n        if (result.ok) {\n          session.login(_this3.state.user.login, result.data);\n\n          _this3.props.navigation.navigate('salesOrder');\n        } else {\n          alert(\"Login ou senha inválido(a).\");\n        }\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return React.createElement(AuthScreenView, {\n        user: this.state.user,\n        customer: this.state.customer,\n        actions: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 95,\n          columnNumber: 16\n        }\n      });\n    }\n  }]);\n\n  return LoginScreen;\n}(Component);\n\nLoginScreen.navigationOptions = function (props) {\n  return {\n    headerTitle: function headerTitle() {\n      return React.createElement(Text, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 21,\n          columnNumber: 32\n        }\n      }, \"Autentica\\xE7\\xE3o\");\n    },\n    headerLeft: function headerLeft() {\n      return React.createElement(MenuIcon, {\n        navigation: props.navigation,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 23,\n          columnNumber: 17\n        }\n      });\n    }\n  };\n};","map":{"version":3,"sources":["/Users/uedsonreis/Documents/Projetos/faculdades/aulas/example-ecommerce-react/src/screens/login/index.tsx"],"names":["React","Component","Text","api","MenuIcon","User","session","Customer","AuthScreenView","LoginScreen","props","state","user","customer","confirmPass","login","undefined","trim","alert","includes","age","password","email","validateForm","body","userPassword","addCustomer","then","result","ok","data","navigation","navigate","JSON","stringify","navigationOptions","headerTitle","headerLeft"],"mappings":"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","sourcesContent":["import React, { Component, ReactNode } from \"react\";\nimport { Text } from \"native-base\";\n\nimport api from '../../utils/connection.api';\nimport { MenuIcon } from \"../../components/SideMenu/menu.icon\";\nimport { User } from \"../../model/user\";\nimport session from '../../storage/user.session';\nimport { Customer } from \"../../model/customer\";\nimport { AuthScreenView } from \"./view\";\n\ntype State = {\n    customer: Customer,\n    user: User,\n    confirmPass: string\n}\n\nexport class LoginScreen extends Component<any, State> {\n\n    static navigationOptions = (props: any) => {\n        return {\n            headerTitle: () => <Text>Autenticação</Text>,\n            headerLeft: () => (\n                <MenuIcon navigation={props.navigation} />\n            ),\n        };\n    };\n\n    constructor(props: any) {\n        super(props);\n        \n        this.state = {\n            user: new User(),\n            customer: new Customer(),\n            confirmPass: \"\"\n        };\n    }\n\n    private validateForm(): boolean {\n        if (this.state.user.login === undefined || this.state.user.login.trim() === '') {\n            alert(\"Este email é inválido!\");\n            return false;\n        }\n\n        if (!this.state.user.login.includes(\"@\") || !this.state.user.login.includes(\".\")) {\n            alert(\"Este email é inválido!\");\n            return false;\n        }\n\n        if (this.state.customer.age === undefined || this.state.customer.age <= 0) {\n            alert(\"Esta idade não é permitida!\");\n            return false;\n        }\n\n        if (this.state.user.password !== this.state.confirmPass) {\n            alert(\"As senhas não conferem!\");\n            return false;\n        }\n\n        this.state.customer.email = this.state.user.login;\n        this.state.customer.user = this.state.user;\n\n        return true;\n    }\n\n    public signup(): void {\n        if (!this.validateForm()) return;\n\n        const body = {\n            ...this.state.customer,\n            userPassword: this.state.customer.user.password\n        };\n\n        api.addCustomer(body).then((result: any) => {\n            if (result.ok) {\n                session.login(this.state.customer.email!, result.data);\n                this.props.navigation.navigate('salesOrder');\n            } else {\n                alert(\"Ocorreu um erro ao salvar o usuário: \"+ JSON.stringify(result.data));\n            }\n        });\n    }\n\n    public login(): void {\n        api.login(this.state.user).then((result: any) => {\n            if (result.ok) {\n                session.login(this.state.user.login!, result.data);\n                this.props.navigation.navigate('salesOrder');\n            } else {\n                alert(\"Login ou senha inválido(a).\");\n            }\n        });\n    }\n\n    public render(): ReactNode {\n        return <AuthScreenView user={this.state.user} customer={this.state.customer} actions={this} />\n    }\n\n}"]},"metadata":{},"sourceType":"module"}