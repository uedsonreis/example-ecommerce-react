{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";import _inherits from\"@babel/runtime/helpers/inherits\";import React,{Component}from\"react\";import{Text}from\"native-base\";import{NavigationActions}from\"react-navigation\";import{DrawerActions}from\"react-navigation-drawer\";import api from\"../../utils/connection.api\";import{MenuIcon}from\"../../components/sidemenu/menu.icon\";import{User}from\"../../model/user\";import session from\"../../storage/user.session\";import{Customer}from\"../../model/customer\";import{AuthScreenView}from\"./login\";export var LoginScreen=function(_Component){_inherits(LoginScreen,_Component);function LoginScreen(props){var _this;_classCallCheck(this,LoginScreen);_this=_possibleConstructorReturn(this,_getPrototypeOf(LoginScreen).call(this,props));_this.state={user:new User(),customer:new Customer(),confirmPass:\"\"};return _this;}_createClass(LoginScreen,[{key:\"navigateToScreen\",value:function navigateToScreen(route){var navigateAction=NavigationActions.navigate({routeName:route});this.props.navigation.dispatch(navigateAction);this.props.navigation.dispatch(DrawerActions.closeDrawer());}},{key:\"validateForm\",value:function validateForm(){if(this.state.user.login===undefined||this.state.user.login.trim()===''){alert(\"Este email é inválido!\");return false;}if(!this.state.user.login.includes(\"@\")||!this.state.user.login.includes(\".\")){alert(\"Este email é inválido!\");return false;}if(this.state.customer.age===undefined||this.state.customer.age<=0){alert(\"Esta idade não é permitida!\");return false;}if(this.state.user.password!==this.state.confirmPass){alert(\"As senhas não conferem!\");return false;}this.state.customer.email=this.state.user.login;this.state.customer.user=this.state.user;return true;}},{key:\"signup\",value:function signup(){var _this2=this;if(!this.validateForm())return;api.post('user/customer/add',this.state.customer).then(function(result){if(result.ok){session.login(_this2.state.customer.email,result.data);_this2.navigateToScreen('Cart');}else{alert(\"Ocorreu um erro ao salvar o usuário: \"+JSON.stringify(result.data));}});}},{key:\"login\",value:function login(){var _this3=this;api.post('user/login',this.state.user).then(function(result){if(result.ok){session.login(_this3.state.user.login,result.data);_this3.navigateToScreen('Cart');}else{alert(\"Login ou senha inválido(a).\");}});}},{key:\"render\",value:function render(){return React.createElement(AuthScreenView,{user:this.state.user,customer:this.state,actions:this});}}]);return LoginScreen;}(Component);LoginScreen.navigationOptions=function(_ref){var navigation=_ref.navigation;return{headerTitle:function headerTitle(){return React.createElement(Text,null,\"Autentica\\xE7\\xE3o\");},headerLeft:function headerLeft(){return React.createElement(MenuIcon,{navigation:navigation});}};};","map":{"version":3,"sources":["/Users/uedsonreis/Documents/Projetos/faculdades/example-ecommerce-react/src/screens/login/index.tsx"],"names":["React","Component","Text","NavigationActions","DrawerActions","api","MenuIcon","User","session","Customer","AuthScreenView","LoginScreen","props","state","user","customer","confirmPass","route","navigateAction","navigate","routeName","navigation","dispatch","closeDrawer","login","undefined","trim","alert","includes","age","password","email","validateForm","post","then","result","ok","data","navigateToScreen","JSON","stringify","navigationOptions","headerTitle","headerLeft"],"mappings":"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","sourcesContent":["import React, { Component, ReactNode } from \"react\";\nimport { Button, Text, Container, Segment } from \"native-base\";\nimport { NavigationActions } from \"react-navigation\";\nimport { DrawerActions } from \"react-navigation-drawer\";\n\nimport api from '../../utils/connection.api';\nimport { MenuIcon } from \"../../components/sidemenu/menu.icon\";\nimport { User } from \"../../model/user\";\nimport session from '../../storage/user.session';\nimport { Customer } from \"../../model/customer\";\nimport { AuthScreenView } from \"./login\";\n\ntype State = {\n    customer: Customer,\n    user: User,\n    confirmPass: string\n}\n\nexport class LoginScreen extends Component<any, State> {\n\n    static navigationOptions = ({ navigation }) => {\n        return {\n            headerTitle: () => <Text>Autenticação</Text>,\n            headerLeft: () => (\n                <MenuIcon navigation={navigation} />\n            ),\n        };\n    };\n\n    constructor(props: any) {\n        super(props);\n        \n        this.state = {\n            user: new User(),\n            customer: new Customer(),\n            confirmPass: \"\"\n        };\n    }\n\n    private navigateToScreen(route: string) {\n        const navigateAction = NavigationActions.navigate({\n            routeName: route\n        });\n        this.props.navigation.dispatch(navigateAction);\n        this.props.navigation.dispatch(DrawerActions.closeDrawer())\n    }\n\n    private validateForm(): boolean {\n        if (this.state.user.login === undefined || this.state.user.login.trim() === '') {\n            alert(\"Este email é inválido!\");\n            return false;\n        }\n\n        if (!this.state.user.login.includes(\"@\") || !this.state.user.login.includes(\".\")) {\n            alert(\"Este email é inválido!\");\n            return false;\n        }\n\n        if (this.state.customer.age === undefined || this.state.customer.age <= 0) {\n            alert(\"Esta idade não é permitida!\");\n            return false;\n        }\n\n        if (this.state.user.password !== this.state.confirmPass) {\n            alert(\"As senhas não conferem!\");\n            return false;\n        }\n\n        this.state.customer.email = this.state.user.login;\n        this.state.customer.user = this.state.user;\n\n        return true;\n    }\n\n    public signup(): void {\n        if (!this.validateForm()) return;\n\n        api.post('user/customer/add', this.state.customer).then((result: any) => {\n            if (result.ok) {\n                session.login(this.state.customer.email, result.data);\n                this.navigateToScreen('Cart');\n            } else {\n                alert(\"Ocorreu um erro ao salvar o usuário: \"+ JSON.stringify(result.data));\n            }\n        });\n    }\n\n    public login(): void {\n        api.post('user/login', this.state.user).then((result: any) => {\n            if (result.ok) {\n                session.login(this.state.user.login, result.data);\n                this.navigateToScreen('Cart');\n            } else {\n                alert(\"Login ou senha inválido(a).\");\n            }\n        });\n    }\n\n    public render(): ReactNode {\n        return <AuthScreenView user={this.state.user} customer={this.state} actions={this} />\n    }\n\n}"]},"metadata":{},"sourceType":"module"}