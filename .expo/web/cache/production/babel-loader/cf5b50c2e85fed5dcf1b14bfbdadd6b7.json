{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import storage from\"./local.storage\";var CartStorage=function(){function CartStorage(){_classCallCheck(this,CartStorage);}_createClass(CartStorage,[{key:\"get\",value:function get(){var value;return _regeneratorRuntime.async(function get$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _regeneratorRuntime.awrap(storage.getItem(CartStorage.LOCAL_VAR));case 2:value=_context.sent;if(!(value!==undefined&&value!==null)){_context.next=7;break;}return _context.abrupt(\"return\",JSON.parse(value));case 7:return _context.abrupt(\"return\",new Array());case 8:case\"end\":return _context.stop();}}});}},{key:\"add\",value:function add(item){var items,itemSaved;return _regeneratorRuntime.async(function add$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return _regeneratorRuntime.awrap(this.get());case 2:items=_context2.sent;itemSaved=this.getItem(items,item.product);if(itemSaved)this.removeItem(items,itemSaved);if(itemSaved!==undefined&&itemSaved!==null){itemSaved.amount=itemSaved.amount+item.amount;items.push(itemSaved);}else{items.push(item);}storage.setItem(CartStorage.LOCAL_VAR,JSON.stringify(items));case 7:case\"end\":return _context2.stop();}}},null,this);}},{key:\"remove\",value:function remove(item){var items,itemSaved;return _regeneratorRuntime.async(function remove$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _regeneratorRuntime.awrap(this.get());case 2:items=_context3.sent;itemSaved=this.getItem(items,item.product);this.removeItem(items,itemSaved);_context3.next=7;return _regeneratorRuntime.awrap(storage.setItem(CartStorage.LOCAL_VAR,JSON.stringify(items)));case 7:case\"end\":return _context3.stop();}}},null,this);}},{key:\"clear\",value:function clear(){return _regeneratorRuntime.async(function clear$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _regeneratorRuntime.awrap(storage.removeItem(CartStorage.LOCAL_VAR));case 2:case\"end\":return _context4.stop();}}});}},{key:\"getItem\",value:function getItem(items,product){return items.find(function(item){return item.product.id===product.id;});}},{key:\"removeItem\",value:function removeItem(items,item){items.splice(items.indexOf(item),1);}}]);return CartStorage;}();CartStorage.LOCAL_VAR=\"CART\";export default new CartStorage();","map":{"version":3,"sources":["/Users/uedsonreis/Documents/Projetos/faculdades/example-ecommerce-react/src/storage/cart.storage.ts"],"names":["storage","CartStorage","getItem","LOCAL_VAR","value","undefined","JSON","parse","Array","item","get","items","itemSaved","product","removeItem","amount","push","setItem","stringify","find","id","splice","indexOf"],"mappings":"4LAGA,MAAOA,CAAAA,OAAP,uB,GAEMC,CAAAA,W,wSAK2BD,OAAO,CAACE,OAAR,CAAgBD,WAAW,CAACE,SAA5B,C,SAAnBC,K,oBACFA,KAAK,GAAKC,SAAV,EAAuBD,KAAK,GAAK,I,0DAC1BE,IAAI,CAACC,KAAL,CAAWH,KAAX,C,yCAEA,GAAII,CAAAA,KAAJ,E,gFAIEC,I,wLACe,KAAKC,GAAL,E,SAAtBC,K,gBAEAC,S,CAAkB,KAAKV,OAAL,CAAaS,KAAb,CAAoBF,IAAI,CAACI,OAAzB,C,CACxB,GAAID,SAAJ,CAAe,KAAKE,UAAL,CAAgBH,KAAhB,CAAuBC,SAAvB,EAEf,GAAIA,SAAS,GAAKP,SAAd,EAA2BO,SAAS,GAAK,IAA7C,CAAmD,CAC/CA,SAAS,CAACG,MAAV,CAAmBH,SAAS,CAACG,MAAV,CAAmBN,IAAI,CAACM,MAA3C,CACAJ,KAAK,CAACK,IAAN,CAAWJ,SAAX,EACH,CAHD,IAGO,CACHD,KAAK,CAACK,IAAN,CAAWP,IAAX,EACH,CACDT,OAAO,CAACiB,OAAR,CAAgBhB,WAAW,CAACE,SAA5B,CAAuCG,IAAI,CAACY,SAAL,CAAeP,KAAf,CAAvC,E,+FAGgBF,I,2LACY,KAAKC,GAAL,E,SAAtBC,K,gBACAC,S,CAAkB,KAAKV,OAAL,CAAaS,KAAb,CAAoBF,IAAI,CAACI,OAAzB,C,CACxB,KAAKC,UAAL,CAAgBH,KAAhB,CAAuBC,SAAvB,E,kDACMZ,OAAO,CAACiB,OAAR,CAAgBhB,WAAW,CAACE,SAA5B,CAAuCG,IAAI,CAACY,SAAL,CAAeP,KAAf,CAAvC,C,qQAIAX,OAAO,CAACc,UAAR,CAAmBb,WAAW,CAACE,SAA/B,C,yFAGMQ,K,CAAeE,O,CAAwB,CACnD,MAAOF,CAAAA,KAAK,CAACQ,IAAN,CAAW,SAACV,IAAD,QAAgBA,CAAAA,IAAI,CAACI,OAAL,CAAaO,EAAb,GAAoBP,OAAO,CAACO,EAA5C,EAAX,CAAP,CACH,C,8CAEkBT,K,CAAeF,I,CAAkB,CAChDE,KAAK,CAACU,MAAN,CAAaV,KAAK,CAACW,OAAN,CAAcb,IAAd,CAAb,CAAkC,CAAlC,EACH,C,2BA7CCR,W,CAEsBE,S,CAAoB,M,CA+ChD,cAAe,IAAIF,CAAAA,WAAJ,EAAf","sourcesContent":["import { Item } from '../model/item';\nimport { Product } from '../model/product';\n\nimport storage from './local.storage';\n\nclass CartStorage {\n\n    private static readonly LOCAL_VAR: string = \"CART\";\n\n    public async get(): Promise<Item[]> {\n        const value: any = await storage.getItem(CartStorage.LOCAL_VAR);\n        if (value !== undefined && value !== null) {\n            return JSON.parse(value) as Array<Item>;\n        } else {\n            return new Array<Item>();\n        }\n    }\n\n    public async add(item: Item): Promise<void> {\n        const items: Item[] = await this.get();\n\n        const itemSaved: Item = this.getItem(items, item.product);\n        if (itemSaved) this.removeItem(items, itemSaved);\n        \n        if (itemSaved !== undefined && itemSaved !== null) {\n            itemSaved.amount = itemSaved.amount + item.amount;\n            items.push(itemSaved);\n        } else {\n            items.push(item);\n        }    \n        storage.setItem(CartStorage.LOCAL_VAR, JSON.stringify(items));\n    }\n\n    public async remove(item: Item): Promise<void> {\n        const items: Item[] = await this.get();\n        const itemSaved: Item = this.getItem(items, item.product);\n        this.removeItem(items, itemSaved);\n        await storage.setItem(CartStorage.LOCAL_VAR, JSON.stringify(items));\n    }\n\n    public async clear(): Promise<void> {\n        await storage.removeItem(CartStorage.LOCAL_VAR);\n    }\n\n    private getItem(items: Item[], product: Product): Item {\n        return items.find((item: Item) => item.product.id === product.id);\n    }\n\n    private removeItem(items: Item[], item: Item): void {\n        items.splice(items.indexOf(item), 1);\n    }\n\n}\n\nexport default new CartStorage();"]},"metadata":{},"sourceType":"module"}